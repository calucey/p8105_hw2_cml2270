---
title: "C.Lucey P8105 Homework 2: Data Wrangling"
output: html_document
---
## Setup
Only done once, the setup code loads the necessary libraries and double checks that the working directory is correct.

```{r setup}
library(tidyverse)
library(readxl)
library(lubridate)
getwd()
```
# Problem 1: Mr. Trash Wheel

## Importing and Cleaning the Mr. Trash Wheel Dataset

```{r import and clean trash man data}

mrtrash_df = read_xlsx("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
           sheet = "Mr. Trash Wheel",
           range = "A2:N408",
           col_names = TRUE
           ) %>%
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = round(sports_balls, 0))

```

## Importing and Cleaning Precipitaiotn Data for 2018 and 2019

```{r import and read precipitation data}
rain_2018 = read_xlsx("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
          sheet = "2018 Precipitation",
          range = "A2:B14",
          col_names = TRUE
          ) %>% 
  janitor::clean_names() %>% 
  mutate(year = 2018) %>% 
  mutate(month = month.name[as.numeric(month)])

rain_2019 = read_xlsx("data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
          sheet = "2019 Precipitation",
          range = "A2:B14",
          col_names = TRUE
          ) %>%
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(year = 2019) %>% 
  mutate(month = month.name[as.numeric(month)])

annualrain_df = bind_rows(rain_2018, rain_2019)

```

## DESCRIPTION OF THESE DATA 

DONT FORGET TO GO BACK AND CHANGE THE NAME OF THE TOTAL PRECIPITAITON COLUMN

# Problem 2: FiveThirtyEight

```{r import pols_month and snp data}

pols_df = read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>% 
  separate(mon, into = c("year", "month", "day")) %>%
  mutate(month = month.name[as.numeric(month)]) %>% 
  mutate(president = 
          ifelse(prez_dem == 1, "dem","gop")) %>% 
  select(-prez_dem, -prez_gop, -day) #%>% 
  mutate(year = as.numeric(year))

snp_df = read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  mutate(date = mdy(date)) %>%
  separate(date, into = c("year","month", "day")) %>%
  mutate(year = as.numeric(year)) %>% 
  mutate(year = ifelse(68 > year %% 100 & 16 > year %% 100, 2000 + year %% 100, 1900 + year %% 100)) %>%
  mutate(month = month.name[as.numeric(month)]) %>% 
  select(-day) %>% 
  relocate(year)
  

#mutate(year = as.numeric(year)) %>%
  #mutate(function(x, year=1968) 
 # m = year(x) %% 100,
  #year(x) = ifelse(m > year %% 100, 1900 + m, 2000 + m))
  

#YEAR DATES ARE WRONG

  #mutate(m = "year", %% 100, year = ifelse(m > year %% 100, 1900 + m, 2000 + m)) %>%


```

```{r tidying unemployment data}

unemploy_df = read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_rate") %>% 
  mutate(month = recode(month, jan = "January", feb = "February", mar = "March", apr = "April", may = "May", jun = "June", jul = "July", aug = "August", sep = "September", oct = "October", nov = "November", dec = "December" ))
```

```{r joining pols and snp}

pols_snp_join = inner_join(snp_df, pols_df, by = c("year", "month"))
```

# Problem 3: Baby Names

```{r import and tidy babynames}

babyname_df = read_csv("data/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  distinct(.keep_all = TRUE) %>% 
  mutate(ethnicity = str_to_lower(ethnicity)) %>% 
  mutate(gender = str_to_lower(gender)) %>% 
  mutate(childs_first_name = str_to_lower(childs_first_name))

```

